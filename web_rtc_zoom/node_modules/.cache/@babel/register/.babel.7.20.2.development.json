{"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\김후성\\\\zoom_clone-master\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\김후성\\\\zoom_clone-master\",\"filename\":\"C:\\\\Users\\\\김후성\\\\zoom_clone-master\\\\src\\\\server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\김후성\\\\zoom_clone-master\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"regenerator-transform\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _socket = _interopRequireDefault(require(\"socket.io\"));\nvar _http = _interopRequireDefault(require(\"http\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n// import WebSocket from \"ws\";\n\nvar PORT = process.env.PORT || 4000;\nvar app = (0, _express[\"default\"])();\nvar cons = require('consolidate');\n\n//view engine setup\napp.engine('html', cons.swig);\napp.set(\"views\", process.cwd() + \"/src/views\");\napp.set('view engine', 'html');\n\n//app.set(\"view engine\", \"pug\");\n//app.set(\"views\", process.cwd() + \"/src/views\");\n\napp.use(\"/public\", _express[\"default\"][\"static\"](process.cwd() + \"/src/public\"));\napp.get(\"/\", function (req, res) {\n  res.render(\"home\");\n});\napp.get(\"/*\", function (req, res) {\n  res.redirect(\"/\");\n});\nvar httpServer = _http[\"default\"].createServer(app);\nvar wsServer = (0, _socket[\"default\"])(httpServer);\nvar roomObjArr = [\n  // {\n  //   roomName,\n  //   currentNum,\n  //   users: [\n  //     {\n  //       socketId,\n  //       nickname,\n  //     },\n  //   ],\n  // },\n];\nvar MAXIMUM = 5; // 최대 인원\n\nwsServer.on(\"connection\", function (socket) {\n  var myRoomName = null;\n  var myNickname = null;\n  socket.on(\"join_room\", function (roomName, nickname) {\n    myRoomName = roomName;\n    myNickname = nickname;\n    var isRoomExist = false;\n    var targetRoomObj = null;\n\n    // forEach를 사용하지 않는 이유: callback함수를 사용하기 때문에 return이 효용없음.\n    for (var i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === roomName) {\n        // Reject join the room\n        if (roomObjArr[i].currentNum >= MAXIMUM) {\n          socket.emit(\"reject_join\");\n          return;\n        }\n        isRoomExist = true;\n        targetRoomObj = roomObjArr[i];\n        break;\n      }\n    }\n\n    // Create room\n    if (!isRoomExist) {\n      targetRoomObj = {\n        roomName: roomName,\n        currentNum: 0,\n        users: []\n      };\n      roomObjArr.push(targetRoomObj);\n    }\n\n    //Join the room\n    targetRoomObj.users.push({\n      socketId: socket.id,\n      nickname: nickname\n    });\n    ++targetRoomObj.currentNum;\n    socket.join(roomName);\n    socket.emit(\"accept_join\", targetRoomObj.users);\n  });\n  socket.on(\"offer\", function (offer, remoteSocketId, localNickname) {\n    socket.to(remoteSocketId).emit(\"offer\", offer, socket.id, localNickname);\n  });\n  socket.on(\"answer\", function (answer, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"answer\", answer, socket.id);\n  });\n  socket.on(\"ice\", function (ice, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"ice\", ice, socket.id);\n  });\n  socket.on(\"chat\", function (message, roomName) {\n    socket.to(roomName).emit(\"chat\", message);\n  });\n  socket.on(\"disconnecting\", function () {\n    socket.to(myRoomName).emit(\"leave_room\", socket.id, myNickname);\n    var isRoomEmpty = false;\n    for (var i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === myRoomName) {\n        var newUsers = roomObjArr[i].users.filter(function (user) {\n          return user.socketId != socket.id;\n        });\n        roomObjArr[i].users = newUsers;\n        --roomObjArr[i].currentNum;\n        if (roomObjArr[i].currentNum == 0) {\n          isRoomEmpty = true;\n        }\n      }\n    }\n\n    // Delete room\n    if (isRoomEmpty) {\n      var newRoomObjArr = roomObjArr.filter(function (roomObj) {\n        return roomObj.currentNum != 0;\n      });\n      roomObjArr = newRoomObjArr;\n    }\n  });\n});\nvar handleListen = function handleListen() {\n  return console.log(\"\\u2705 Listening on http://localhost:\".concat(PORT));\n};\nhttpServer.listen(PORT, handleListen);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQT1JUIiwicHJvY2VzcyIsImVudiIsImFwcCIsImV4cHJlc3MiLCJjb25zIiwicmVxdWlyZSIsImVuZ2luZSIsInN3aWciLCJzZXQiLCJjd2QiLCJ1c2UiLCJnZXQiLCJyZXEiLCJyZXMiLCJyZW5kZXIiLCJyZWRpcmVjdCIsImh0dHBTZXJ2ZXIiLCJodHRwIiwiY3JlYXRlU2VydmVyIiwid3NTZXJ2ZXIiLCJTb2NrZXRJTyIsInJvb21PYmpBcnIiLCJNQVhJTVVNIiwib24iLCJzb2NrZXQiLCJteVJvb21OYW1lIiwibXlOaWNrbmFtZSIsInJvb21OYW1lIiwibmlja25hbWUiLCJpc1Jvb21FeGlzdCIsInRhcmdldFJvb21PYmoiLCJpIiwibGVuZ3RoIiwiY3VycmVudE51bSIsImVtaXQiLCJ1c2VycyIsInB1c2giLCJzb2NrZXRJZCIsImlkIiwiam9pbiIsIm9mZmVyIiwicmVtb3RlU29ja2V0SWQiLCJsb2NhbE5pY2tuYW1lIiwidG8iLCJhbnN3ZXIiLCJpY2UiLCJtZXNzYWdlIiwiaXNSb29tRW1wdHkiLCJuZXdVc2VycyIsImZpbHRlciIsInVzZXIiLCJuZXdSb29tT2JqQXJyIiwicm9vbU9iaiIsImhhbmRsZUxpc3RlbiIsImNvbnNvbGUiLCJsb2ciLCJsaXN0ZW4iXSwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xc6rmA7ZuE7ISxXFx6b29tX2Nsb25lLW1hc3Rlclxcc3JjXFwiLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xuLy8gaW1wb3J0IFdlYlNvY2tldCBmcm9tIFwid3NcIjtcbmltcG9ydCBTb2NrZXRJTyBmcm9tIFwic29ja2V0LmlvXCI7XG5pbXBvcnQgaHR0cCBmcm9tIFwiaHR0cFwiO1xuXG5jb25zdCBQT1JUID0gcHJvY2Vzcy5lbnYuUE9SVCB8fCA0MDAwO1xuXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XG5cbnZhciBjb25zID0gcmVxdWlyZSgnY29uc29saWRhdGUnKTtcblxuLy92aWV3IGVuZ2luZSBzZXR1cFxuYXBwLmVuZ2luZSgnaHRtbCcsIGNvbnMuc3dpZylcbmFwcC5zZXQoXCJ2aWV3c1wiLCBwcm9jZXNzLmN3ZCgpICsgXCIvc3JjL3ZpZXdzXCIpO1xuYXBwLnNldCgndmlldyBlbmdpbmUnLCAnaHRtbCcpO1xuXG4vL2FwcC5zZXQoXCJ2aWV3IGVuZ2luZVwiLCBcInB1Z1wiKTtcbi8vYXBwLnNldChcInZpZXdzXCIsIHByb2Nlc3MuY3dkKCkgKyBcIi9zcmMvdmlld3NcIik7XG5cbmFwcC51c2UoXCIvcHVibGljXCIsIGV4cHJlc3Muc3RhdGljKHByb2Nlc3MuY3dkKCkgKyBcIi9zcmMvcHVibGljXCIpKTtcblxuYXBwLmdldChcIi9cIiwgKHJlcSwgcmVzKSA9PiB7XG4gIHJlcy5yZW5kZXIoXCJob21lXCIpO1xufSk7XG5cbmFwcC5nZXQoXCIvKlwiLCAocmVxLCByZXMpID0+IHtcbiAgcmVzLnJlZGlyZWN0KFwiL1wiKTtcbn0pO1xuXG5jb25zdCBodHRwU2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoYXBwKTtcbmNvbnN0IHdzU2VydmVyID0gU29ja2V0SU8oaHR0cFNlcnZlcik7XG5cbmxldCByb29tT2JqQXJyID0gW1xuICAvLyB7XG4gIC8vICAgcm9vbU5hbWUsXG4gIC8vICAgY3VycmVudE51bSxcbiAgLy8gICB1c2VyczogW1xuICAvLyAgICAge1xuICAvLyAgICAgICBzb2NrZXRJZCxcbiAgLy8gICAgICAgbmlja25hbWUsXG4gIC8vICAgICB9LFxuICAvLyAgIF0sXG4gIC8vIH0sXG5dO1xuY29uc3QgTUFYSU1VTSA9IDU7IC8vIOy1nOuMgCDsnbjsm5Bcblxud3NTZXJ2ZXIub24oXCJjb25uZWN0aW9uXCIsIChzb2NrZXQpID0+IHtcbiAgbGV0IG15Um9vbU5hbWUgPSBudWxsO1xuICBsZXQgbXlOaWNrbmFtZSA9IG51bGw7XG5cbiAgc29ja2V0Lm9uKFwiam9pbl9yb29tXCIsIChyb29tTmFtZSwgbmlja25hbWUpID0+IHtcbiAgICBteVJvb21OYW1lID0gcm9vbU5hbWU7XG4gICAgbXlOaWNrbmFtZSA9IG5pY2tuYW1lO1xuXG4gICAgbGV0IGlzUm9vbUV4aXN0ID0gZmFsc2U7XG4gICAgbGV0IHRhcmdldFJvb21PYmogPSBudWxsO1xuXG4gICAgLy8gZm9yRWFjaOulvCDsgqzsmqntlZjsp4Ag7JWK64qUIOydtOycoDogY2FsbGJhY2vtlajsiJjrpbwg7IKs7Jqp7ZWY6riwIOuVjOusuOyXkCByZXR1cm7snbQg7Zqo7Jqp7JeG7J2MLlxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm9vbU9iakFyci5sZW5ndGg7ICsraSkge1xuICAgICAgaWYgKHJvb21PYmpBcnJbaV0ucm9vbU5hbWUgPT09IHJvb21OYW1lKSB7XG4gICAgICAgIC8vIFJlamVjdCBqb2luIHRoZSByb29tXG4gICAgICAgIGlmIChyb29tT2JqQXJyW2ldLmN1cnJlbnROdW0gPj0gTUFYSU1VTSkge1xuICAgICAgICAgIHNvY2tldC5lbWl0KFwicmVqZWN0X2pvaW5cIik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaXNSb29tRXhpc3QgPSB0cnVlO1xuICAgICAgICB0YXJnZXRSb29tT2JqID0gcm9vbU9iakFycltpXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHJvb21cbiAgICBpZiAoIWlzUm9vbUV4aXN0KSB7XG4gICAgICB0YXJnZXRSb29tT2JqID0ge1xuICAgICAgICByb29tTmFtZSxcbiAgICAgICAgY3VycmVudE51bTogMCxcbiAgICAgICAgdXNlcnM6IFtdLFxuICAgICAgfTtcbiAgICAgIHJvb21PYmpBcnIucHVzaCh0YXJnZXRSb29tT2JqKTtcbiAgICB9XG5cbiAgICAvL0pvaW4gdGhlIHJvb21cbiAgICB0YXJnZXRSb29tT2JqLnVzZXJzLnB1c2goe1xuICAgICAgc29ja2V0SWQ6IHNvY2tldC5pZCxcbiAgICAgIG5pY2tuYW1lLFxuICAgIH0pO1xuICAgICsrdGFyZ2V0Um9vbU9iai5jdXJyZW50TnVtO1xuXG4gICAgc29ja2V0LmpvaW4ocm9vbU5hbWUpO1xuICAgIHNvY2tldC5lbWl0KFwiYWNjZXB0X2pvaW5cIiwgdGFyZ2V0Um9vbU9iai51c2Vycyk7XG4gIH0pO1xuXG4gIHNvY2tldC5vbihcIm9mZmVyXCIsIChvZmZlciwgcmVtb3RlU29ja2V0SWQsIGxvY2FsTmlja25hbWUpID0+IHtcbiAgICBzb2NrZXQudG8ocmVtb3RlU29ja2V0SWQpLmVtaXQoXCJvZmZlclwiLCBvZmZlciwgc29ja2V0LmlkLCBsb2NhbE5pY2tuYW1lKTtcbiAgfSk7XG5cbiAgc29ja2V0Lm9uKFwiYW5zd2VyXCIsIChhbnN3ZXIsIHJlbW90ZVNvY2tldElkKSA9PiB7XG4gICAgc29ja2V0LnRvKHJlbW90ZVNvY2tldElkKS5lbWl0KFwiYW5zd2VyXCIsIGFuc3dlciwgc29ja2V0LmlkKTtcbiAgfSk7XG5cbiAgc29ja2V0Lm9uKFwiaWNlXCIsIChpY2UsIHJlbW90ZVNvY2tldElkKSA9PiB7XG4gICAgc29ja2V0LnRvKHJlbW90ZVNvY2tldElkKS5lbWl0KFwiaWNlXCIsIGljZSwgc29ja2V0LmlkKTtcbiAgfSk7XG5cbiAgc29ja2V0Lm9uKFwiY2hhdFwiLCAobWVzc2FnZSwgcm9vbU5hbWUpID0+IHtcbiAgICBzb2NrZXQudG8ocm9vbU5hbWUpLmVtaXQoXCJjaGF0XCIsIG1lc3NhZ2UpO1xuICB9KTtcblxuICBzb2NrZXQub24oXCJkaXNjb25uZWN0aW5nXCIsICgpID0+IHtcbiAgICBzb2NrZXQudG8obXlSb29tTmFtZSkuZW1pdChcImxlYXZlX3Jvb21cIiwgc29ja2V0LmlkLCBteU5pY2tuYW1lKTtcblxuICAgIGxldCBpc1Jvb21FbXB0eSA9IGZhbHNlO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm9vbU9iakFyci5sZW5ndGg7ICsraSkge1xuICAgICAgaWYgKHJvb21PYmpBcnJbaV0ucm9vbU5hbWUgPT09IG15Um9vbU5hbWUpIHtcbiAgICAgICAgY29uc3QgbmV3VXNlcnMgPSByb29tT2JqQXJyW2ldLnVzZXJzLmZpbHRlcihcbiAgICAgICAgICAodXNlcikgPT4gdXNlci5zb2NrZXRJZCAhPSBzb2NrZXQuaWRcbiAgICAgICAgKTtcbiAgICAgICAgcm9vbU9iakFycltpXS51c2VycyA9IG5ld1VzZXJzO1xuICAgICAgICAtLXJvb21PYmpBcnJbaV0uY3VycmVudE51bTtcblxuICAgICAgICBpZiAocm9vbU9iakFycltpXS5jdXJyZW50TnVtID09IDApIHtcbiAgICAgICAgICBpc1Jvb21FbXB0eSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBEZWxldGUgcm9vbVxuICAgIGlmIChpc1Jvb21FbXB0eSkge1xuICAgICAgY29uc3QgbmV3Um9vbU9iakFyciA9IHJvb21PYmpBcnIuZmlsdGVyKFxuICAgICAgICAocm9vbU9iaikgPT4gcm9vbU9iai5jdXJyZW50TnVtICE9IDBcbiAgICAgICk7XG4gICAgICByb29tT2JqQXJyID0gbmV3Um9vbU9iakFycjtcbiAgICB9XG4gIH0pO1xufSk7XG5cbmNvbnN0IGhhbmRsZUxpc3RlbiA9ICgpID0+XG4gIGNvbnNvbGUubG9nKGDinIUgTGlzdGVuaW5nIG9uIGh0dHA6Ly9sb2NhbGhvc3Q6JHtQT1JUfWApO1xuaHR0cFNlcnZlci5saXN0ZW4oUE9SVCwgaGFuZGxlTGlzdGVuKTtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUVBO0FBQ0E7QUFBd0I7QUFGeEI7O0FBSUEsSUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsSUFBSSxJQUFJLElBQUk7QUFFckMsSUFBTUcsR0FBRyxHQUFHLElBQUFDLG1CQUFPLEdBQUU7QUFFckIsSUFBSUMsSUFBSSxHQUFHQyxPQUFPLENBQUMsYUFBYSxDQUFDOztBQUVqQztBQUNBSCxHQUFHLENBQUNJLE1BQU0sQ0FBQyxNQUFNLEVBQUVGLElBQUksQ0FBQ0csSUFBSSxDQUFDO0FBQzdCTCxHQUFHLENBQUNNLEdBQUcs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","map":{"version":3,"names":["PORT","process","env","app","express","cons","require","engine","swig","set","cwd","use","get","req","res","render","redirect","httpServer","http","createServer","wsServer","SocketIO","roomObjArr","MAXIMUM","on","socket","myRoomName","myNickname","roomName","nickname","isRoomExist","targetRoomObj","i","length","currentNum","emit","users","push","socketId","id","join","offer","remoteSocketId","localNickname","to","answer","ice","message","isRoomEmpty","newUsers","filter","user","newRoomObjArr","roomObj","handleListen","console","log","listen"],"sourceRoot":"C:\\Users\\김후성\\zoom_clone-master\\src\\","sources":["server.js"],"sourcesContent":["import express from \"express\";\n// import WebSocket from \"ws\";\nimport SocketIO from \"socket.io\";\nimport http from \"http\";\n\nconst PORT = process.env.PORT || 4000;\n\nconst app = express();\n\nvar cons = require('consolidate');\n\n//view engine setup\napp.engine('html', cons.swig)\napp.set(\"views\", process.cwd() + \"/src/views\");\napp.set('view engine', 'html');\n\n//app.set(\"view engine\", \"pug\");\n//app.set(\"views\", process.cwd() + \"/src/views\");\n\napp.use(\"/public\", express.static(process.cwd() + \"/src/public\"));\n\napp.get(\"/\", (req, res) => {\n  res.render(\"home\");\n});\n\napp.get(\"/*\", (req, res) => {\n  res.redirect(\"/\");\n});\n\nconst httpServer = http.createServer(app);\nconst wsServer = SocketIO(httpServer);\n\nlet roomObjArr = [\n  // {\n  //   roomName,\n  //   currentNum,\n  //   users: [\n  //     {\n  //       socketId,\n  //       nickname,\n  //     },\n  //   ],\n  // },\n];\nconst MAXIMUM = 5; // 최대 인원\n\nwsServer.on(\"connection\", (socket) => {\n  let myRoomName = null;\n  let myNickname = null;\n\n  socket.on(\"join_room\", (roomName, nickname) => {\n    myRoomName = roomName;\n    myNickname = nickname;\n\n    let isRoomExist = false;\n    let targetRoomObj = null;\n\n    // forEach를 사용하지 않는 이유: callback함수를 사용하기 때문에 return이 효용없음.\n    for (let i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === roomName) {\n        // Reject join the room\n        if (roomObjArr[i].currentNum >= MAXIMUM) {\n          socket.emit(\"reject_join\");\n          return;\n        }\n\n        isRoomExist = true;\n        targetRoomObj = roomObjArr[i];\n        break;\n      }\n    }\n\n    // Create room\n    if (!isRoomExist) {\n      targetRoomObj = {\n        roomName,\n        currentNum: 0,\n        users: [],\n      };\n      roomObjArr.push(targetRoomObj);\n    }\n\n    //Join the room\n    targetRoomObj.users.push({\n      socketId: socket.id,\n      nickname,\n    });\n    ++targetRoomObj.currentNum;\n\n    socket.join(roomName);\n    socket.emit(\"accept_join\", targetRoomObj.users);\n  });\n\n  socket.on(\"offer\", (offer, remoteSocketId, localNickname) => {\n    socket.to(remoteSocketId).emit(\"offer\", offer, socket.id, localNickname);\n  });\n\n  socket.on(\"answer\", (answer, remoteSocketId) => {\n    socket.to(remoteSocketId).emit(\"answer\", answer, socket.id);\n  });\n\n  socket.on(\"ice\", (ice, remoteSocketId) => {\n    socket.to(remoteSocketId).emit(\"ice\", ice, socket.id);\n  });\n\n  socket.on(\"chat\", (message, roomName) => {\n    socket.to(roomName).emit(\"chat\", message);\n  });\n\n  socket.on(\"disconnecting\", () => {\n    socket.to(myRoomName).emit(\"leave_room\", socket.id, myNickname);\n\n    let isRoomEmpty = false;\n    for (let i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === myRoomName) {\n        const newUsers = roomObjArr[i].users.filter(\n          (user) => user.socketId != socket.id\n        );\n        roomObjArr[i].users = newUsers;\n        --roomObjArr[i].currentNum;\n\n        if (roomObjArr[i].currentNum == 0) {\n          isRoomEmpty = true;\n        }\n      }\n    }\n\n    // Delete room\n    if (isRoomEmpty) {\n      const newRoomObjArr = roomObjArr.filter(\n        (roomObj) => roomObj.currentNum != 0\n      );\n      roomObjArr = newRoomObjArr;\n    }\n  });\n});\n\nconst handleListen = () =>\n  console.log(`✅ Listening on http://localhost:${PORT}`);\nhttpServer.listen(PORT, handleListen);\n"],"mappings":"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"}},"mtime":1668162589260}}